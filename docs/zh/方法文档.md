# Storage Provider 方法文档

---
---

## 辅助方法

### 1. `circular`

#### 作用

去除非 null 对象/数组中的循环引用内容

#### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| item | ture | `object` 或 `Array<any>` | 要去除循环引用的对象或数组 |

#### 返回值

| 类型 | 说明 |
| --- | --- |
| `object` 或 `Array<any>` | 已经去除循环引用的对象或数组 |

---

## 2. `inspector`

### 作用

验证本地存储中指定的项是否满足制定规则的方法

### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| obj | ture | { [storageKey: string]: string | (item: any) => boolean } | 指定的项及其验证规则，详细规则见下 |

- 该对象中的每一个属性的键名将作为存储的键名，属性值将作为验证规则；
- 验证规则可以是字符串，也可以是一个函数，该函数的返回值必须为布尔值；
- 如果是字符串，则检测 Storage 中 storageKey 对应的值的类型是否与该字符串相等；
- 如果是函数，则调用该函数，传入 Storage 中 storageKey 对应的值，如果函数返回 true，则验证通过，否则验证失败。

### 返回值

| 类型 | 说明 |
| --- | --- |
| { all: boolean, tips: {  [storageKey: string]: string  },  errors: {  [storageKey: string]: string  } } | 验证结果对象：<br/>- all: 所有的项目验证是否通过，全部通过为 true，任一不通过为 false；<br/>- tips: 验证提示信息；<br/>- errors: 验证失败的项目及其对应的错误信息。 |

---
---

## 存储及获取内容的方法

### 1. `Storage`

#### 作用

设置或获取单条存储数据

#### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| key | ture | string | 数据的键名 |
| value | false | any | 要存储的值 |

#### 返回值

| 类型 | 说明 |
| --- | --- |
| void | 如果 value 有效，则存储值，无返回值 |
| any | 如果 value 无效，则返回存储的值 |

---
---

## 存储内容的方法

### 1. `Save`

#### 作用

设置单条存储数据

#### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| key | ture | string | 数据的键名 |
| value | ture | any | 要存储的值 |

#### 返回值

无

#### 抛出异常缘由

- value 无效

---

### 2. `SaveMany`

#### 作用

设置多条存储数据

#### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| arr | ture | array | 要存储的多条数据。数组中的每个元素都必须是包含`key`和`value`属性的对象 |

#### 返回值

无

---

### 3. `Set`

#### 作用

设置单条或多条存储数据

#### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| ...arg | ture | any | 要存储的单条或多条存储数据 |

##### 特别说明

- 本方法传入参数数量必须为 1 ~ 2 个
- 本方法传入参数的原则如下：
   1. 仅传入一个参数的情况下：
      - 参数为对象：
         - 对象的格式为 `{ key: value }`
         - 对象中不能存在无效值
         - 对象不得为空
         - 对象中可以存在多个键值对
         - 对象的属性键即为存储的 key
         - 对象的属性值即为存储的 value
      - 参数为数组：
         - 数组不得为空
         - 数组中的元素内容必须为对象
         - 数组中的元素内容对象格式为 `{ key: "string", value: any }`
         - 数组中不得包含其他类型的元素
   2. 传入两个参数的情况下：
      - 两个参数均须要有效
      - 第一个参数必须为字符串
      - 第二个参数类型可以是任意
      - 第一个参数将被解析为 key
      - 第二个参数将被解析为 value

#### 返回值

无

---
---

## 获取内容的方法

所有的获取方法在获取内容的时候，如果传入的 `key` 在存储中没有找到有效数据，则返回 `null` 。

### 1. `Get`

#### 作用

获取单条存储数据

#### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| key | ture | string | 数据的键名 |

#### 返回值

| 类型 | 说明 |
| --- | --- |
| any | 返回获取到的键名对应的值 |

---

### 2. `GetMany`

#### 作用

从存储中获取多个键对应的值

#### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| arr | ture | string[] | 包含需要获取值的键的数组 |
| type | false | string | 默认为"array"，具体用法详见下 |

#### 返回值

| 类型 | 说明 | 格式示例 |
| --- | --- | --- |
| array | 包含键值对的对象数组 | `[{"key1":value1},{"key2":value2}, ...]` |
| object | 包含键值对的对象 | `{"key1":value1,"key2":value2, ...}` |
| array | 包含键值对的对象数组 | `[{"key":"key1","value":value1},{"key":"key2","value":value2}, ...]` |

#### 关于参数 type 的具体说明

- 如果 type 是 "array"，则将字符串数组中的每个元素作为键，对应的存储值作为值，构成一个对象数组，格式为 `[{ key1: value1 }, { key2: value2 }, ...]`。
- 如果 type 是 "object"，则将字符串数组中的每个元素作为键，对应的存储值作为值，构成一个对象，格式为 `{ key1: value1, key2: value2, ... }`。
- 如果 type 是 "array-object"，则将字符串数组中的每个元素作为键，并将键值对的格式放入一个对象数组中，格式为 `[{ key: "key1", value: value1 }, { key: "key2", value: value2 }, ...]`。

示例代码如下

```javascript
import { $local } from "StorageProvider.js";

const result = $local.GetMany(["key1", "key2", "key3"]);
const result = $local.GetMany(["key1", "key2", "key3"], "array");
// 上述两种返回值一致，格式均为
// [{ "key1": value1 }, { "key2": value2 }, { "key3": value3 }]

const result = $local.GetMany(["key1", "key2", "key3"], "object");
// 上述返回值格式为
// { "key1": value1, "key2": value2, "key3": value3 }

const result = $local.GetMany(["key1", "key2", "key3"], "array-object");
// 上述返回值格式为
// [{ "key": "key1", value" value1 }, { "key": "key2", value" value2 }, { "key": "key3", value" value3 }]
```

---

### 3. `GetAll`

#### 作用

从存储中获取多个键对应的值

#### 参数

无

#### 返回值

| 类型 | 说明 | 格式示例 |
| --- | --- | --- |
| object | 包含所有本地存储数据的对象 | `{key1: value1, key2: value2, ...}` |

---
---

## 删除存储数据的方法

### 1、`Delete`

#### 作用

删除单条或所有存储数据

#### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| key | false | string | 要删除的数据的键名。传入参数，则删除单条；不传参数，则删除所有 |

#### 返回值

无

---

### 2、`Remove`

#### 作用

删除单条存储数据

#### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| key | true | string | 要删除的数据的键名 |

#### 返回值

无

---

### 3、`RemoveMany`

#### 作用

删除多条存储数据

#### 参数

| 参数 | 必选 | 类型 | 说明 |
| --- | --- | --- | --- |
| arr | true | array | 包含需要删除的键的数组，数组内部内容的格式必须为 `string` |

#### 返回值

无

---

### 4、`Clean`

#### 作用

删除存储的所有数据

#### 参数

无

#### 返回值

无
